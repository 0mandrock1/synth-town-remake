/* === RESET === */
* { margin: 0; padding: 0; box-sizing: border-box; }
body { overflow: hidden; font-family: 'Inter', sans-serif; }

/* === LAYOUT === */
#app {
  display: grid;
  grid-template-areas:
    "toolbar main properties"
    "transport transport transport";
  grid-template-columns: 200px 1fr 0px;
  grid-template-rows: 1fr 64px;
  height: 100vh;
  background: #0a0a12;
  color: #e0e0e0;
}

/* === TOOLBAR === */
#toolbar {
  grid-area: toolbar;
  background: #12122a;
  border-right: 1px solid rgba(255,255,255,0.1);
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 3px;
  overflow-y: auto;
}
.st-toolbar-section {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: rgba(255,255,255,0.3);
  margin: 8px 4px 4px;
}
.st-tool-btn {
  background: transparent;
  color: #e0e0e0;
  border: 1px solid rgba(255,255,255,0.1);
  padding: 7px 10px;
  text-align: left;
  cursor: pointer;
  border-radius: 4px;
  font-size: 12px;
  font-family: inherit;
  display: flex;
  align-items: center;
  gap: 8px;
}
.st-tool-btn:hover { background: rgba(255,255,255,0.06); }
.st-tool-btn.st-active { background: rgba(100,181,246,0.15); border-color: #64b5f6; color: #64b5f6; }
.st-color-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

/* === MAIN CANVAS === */
main {
  grid-area: main;
  overflow: auto;
  display: flex;
  align-items: flex-start;
  justify-content: flex-start;
}
#game { display: block; cursor: crosshair; }

/* === PROPERTY PANEL === */
#properties {
  grid-area: properties;
  background: #12122a;
  border-left: 1px solid rgba(255,255,255,0.1);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}
.st-props-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
}
.st-props-title { font-size: 13px; font-weight: 600; flex: 1; }
.st-props-close {
  background: none;
  border: none;
  color: rgba(255,255,255,0.4);
  cursor: pointer;
  font-size: 16px;
  padding: 2px 6px;
  border-radius: 3px;
}
.st-props-close:hover { color: #e0e0e0; background: rgba(255,255,255,0.08); }
.st-props-body { padding: 12px; display: flex; flex-direction: column; gap: 12px; }
.st-props-row { display: flex; flex-direction: column; gap: 4px; }
.st-props-label { font-size: 10px; text-transform: uppercase; letter-spacing: 0.08em; color: rgba(255,255,255,0.4); }
.st-props-value { font-size: 12px; color: #e0e0e0; }
.st-props-row input[type="range"] { width: 100%; accent-color: #64b5f6; cursor: pointer; }

/* === TRANSPORT BAR === */
#transport {
  grid-area: transport;
  background: #12122a;
  border-top: 1px solid rgba(255,255,255,0.1);
  display: flex;
  align-items: center;
  padding: 0 16px;
  gap: 12px;
}
#btn-play {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #64b5f6;
  color: #0a0a12;
  border: none;
  cursor: pointer;
  font-size: 16px;
  font-weight: bold;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}
#btn-play:hover { background: #90caf9; }
#btn-play.st-active { background: #ef5350; }
.st-transport-label { font-size: 11px; color: rgba(255,255,255,0.4); white-space: nowrap; }
#slider-bpm { width: 120px; cursor: pointer; accent-color: #64b5f6; }
#slider-vol { width: 72px; cursor: pointer; accent-color: #66bb6a; }
#bpm-display { font-size: 13px; color: #64b5f6; font-weight: 600; min-width: 36px; }
#status-display { font-size: 11px; color: rgba(255,255,255,0.3); }
#fps-display { font-size: 11px; color: rgba(255,255,255,0.3); margin-left: auto; }

/* === MODALS & OVERLAYS === */
#audio-overlay {
  position: fixed;
  inset: 0;
  background: rgba(10,10,18,0.95);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 100;
  gap: 16px;
}
#audio-overlay h2 { font-size: 24px; color: #64b5f6; }
#audio-overlay p { font-size: 14px; color: rgba(255,255,255,0.4); }
#btn-start-audio {
  background: #64b5f6;
  color: #0a0a12;
  border: none;
  padding: 12px 32px;
  font-size: 16px;
  font-weight: 600;
  border-radius: 6px;
  cursor: pointer;
}
#btn-start-audio:hover { background: #90caf9; }

/* === PIANO PICKER === */
.st-piano-wrap { display: flex; flex-direction: column; gap: 6px; }
.st-piano-nav {
  display: flex; align-items: center; justify-content: space-between; gap: 4px;
}
.st-piano-oct-label { font-size: 12px; color: #e0e0e0; text-align: center; min-width: 32px; }
.st-oct-btn {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.1);
  color: #e0e0e0; cursor: pointer; border-radius: 3px;
  width: 24px; height: 22px; font-size: 14px; font-family: inherit;
  display: flex; align-items: center; justify-content: center; padding: 0;
}
.st-oct-btn:hover { background: rgba(255,255,255,0.15); }
.st-piano-keys { position: relative; height: 60px; width: 196px; }
.st-white-key {
  position: absolute; top: 0; width: 28px; height: 60px;
  background: #d8d8d8; border-right: 1px solid #555; border-bottom: 1px solid #555;
  border-radius: 0 0 3px 3px; cursor: pointer; box-sizing: border-box;
}
.st-white-key:hover { background: #fff; }
.st-black-key {
  position: absolute; top: 0; width: 18px; height: 36px;
  background: #1a1a2e; border: 1px solid #444;
  border-radius: 0 0 3px 3px; cursor: pointer; box-sizing: border-box; z-index: 2;
}
.st-black-key:hover { background: #2e2e5e; }

/* === LOCKED TOOL === */
.st-tool-btn.st-locked { opacity: 0.32; cursor: not-allowed; pointer-events: none; }

/* === UNLOCK TOAST === */
.st-unlock-toast {
  position: fixed; bottom: 80px; left: 50%;
  transform: translateX(-50%) translateY(10px);
  background: #1a3a1a; border: 1px solid #66bb6a; color: #66bb6a;
  padding: 8px 20px; border-radius: 6px; font-size: 13px; z-index: 50;
  animation: st-toast-fade 3s forwards;
}
@keyframes st-toast-fade {
  0%   { opacity: 0; transform: translateX(-50%) translateY(10px); }
  15%  { opacity: 1; transform: translateX(-50%) translateY(0); }
  80%  { opacity: 1; }
  100% { opacity: 0; }
}

/* === TOOLTIP === */
#st-tooltip {
  position: fixed;
  background: rgba(10,10,24,0.97);
  border: 1px solid rgba(100,181,246,0.35);
  color: #e0e0e0;
  padding: 6px 10px;
  border-radius: 5px;
  font-size: 11px;
  line-height: 1.55;
  pointer-events: none;
  z-index: 400;
  max-width: 230px;
  display: none;
  box-shadow: 0 3px 10px rgba(0,0,0,0.55);
}
#st-tooltip strong { color: #90caf9; display: block; margin-bottom: 2px; }

/* === SCORE TIER FLASH (JD-U4) === */
@keyframes st-tier-flash {
  0%   { color: #ffa726; text-shadow: none; }
  20%  { color: #ffd740; text-shadow: 0 0 12px rgba(255,215,64,0.85); }
  100% { color: #ffa726; text-shadow: none; }
}
.st-tier-flash { animation: st-tier-flash 1.4s ease-out forwards; }

/* === BEAT DOT (QW-U4) === */
#beat-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--accent, #64b5f6);
  opacity: 0.3;
  transition: transform 0.05s, opacity 0.05s;
  flex-shrink: 0;
}
#beat-dot.st-pulse {
  transform: scale(1.9);
  opacity: 1.0;
}

/* === LEVEL CONTROL BUTTONS (QW-M1) === */
.st-props-btn {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.15);
  color: #e0e0e0;
  cursor: pointer;
  border-radius: 3px;
  width: 22px;
  height: 22px;
  font-size: 14px;
  font-family: inherit;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}
.st-props-btn:hover { background: rgba(255,255,255,0.15); }

/* === SCORE === */
#score-display { font-size: 12px; color: #ffa726; font-weight: 500; }
#btn-export-midi {
  background: transparent;
  color: rgba(255,255,255,0.5);
  border: 1px solid rgba(255,255,255,0.15);
  padding: 4px 10px;
  border-radius: 4px;
  font-size: 11px;
  font-family: inherit;
  cursor: pointer;
  margin-left: auto;
}
#btn-export-midi:hover { background: rgba(255,255,255,0.06); color: #e0e0e0; }

/* === ONBOARDING === */
#onboard-hint {
  background: rgba(100,181,246,0.1);
  border: 1px solid rgba(100,181,246,0.25);
  border-radius: 4px;
  padding: 8px 10px;
  font-size: 11px;
  color: #90caf9;
  line-height: 1.5;
  margin-bottom: 4px;
}
@keyframes st-onboard-pulse {
  0%, 100% { border-color: rgba(100,181,246,0.35); }
  50% { border-color: #64b5f6; box-shadow: 0 0 8px rgba(100,181,246,0.45); }
}
.st-onboard-pulse { animation: st-onboard-pulse 1.2s ease-in-out infinite; }
